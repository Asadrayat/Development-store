<script>
  document.addEventListener("DOMContentLoaded", function () {
    const atcBtns = document.querySelectorAll("[data-atc-btn]");
    const infoContainers = document.querySelectorAll("[data-stl-container]");
    atcBtns.forEach((btn) => {
      btn.addEventListener("click", function () {
        // Grab the variant ID from a data attribute
        const variantId = btn.getAttribute("data-variant-id");

        // Prepare the form data
        const formData = new FormData();
        formData.append('id', variantId);
        formData.append('quantity', 1); // Change this if needed

        // Send fetch request to Shopify
        fetch(window.Shopify.routes.root + 'cart/add.js', {
          method: 'POST',
          body: formData,
          headers: {
            'Accept': 'application/json'
          }
        })
        .then(response => response.json())
        .then(data => {
          infoContainers.forEach(infoContainer => {
          if (infoContainer.classList.contains("active"))
            infoContainer.classList.remove("active");

          });
            const this_cartDrawer = document.querySelector('cart-drawer');
            this_cartDrawer.refresh(true);
          })
          .catch((error) => {
            console.error('Error adding to cart:', error);
          });
       });
    });
  });
</script>
